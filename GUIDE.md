# yoAdminPortal ユーザーガイド

yoAdminPortalは、管理ツールへのアクセスを一元化するポータル画面です。
ユーザー権限に基づいてアクセス可能なツールのみを表示します。

---

## 📋 目次

1. [概要](#概要)
2. [ポータル画面の使い方](#ポータル画面の使い方)
3. [ポータルビルダーの使い方](#ポータルビルダーの使い方)
4. [権限管理](#権限管理)
5. [テーマ設定](#テーマ設定)
6. [トラブルシューティング](#トラブルシューティング)

---

## 概要

### ファイル構成

| ファイル | 説明 |
|---------|------|
| `viewer.php` | ポータル画面（ユーザー向け） |
| `builder.php` | ポータル編集画面（管理者向け） |
| `portal_config.json` | ポータル設定ファイル |
| `auth.php` | 認証・権限チェック |

### アクセスURL

- **ポータル画面**: `/yoAdminPortal/viewer.php`
- **ポータル編集**: `/yoAdminPortal/builder.php`

---

## ポータル画面の使い方

### 基本操作

1. ログイン後、ポータル画面が表示されます
2. アイコンカードをクリックすると、対応するツールが開きます
3. 各ツールは新しいタブで開きます

### 表示されるリンク

ユーザーの権限に基づいて、アクセス可能なツールのみが表示されます。
- **管理者（権限: `*`）**: すべてのリンクが表示
- **一般ユーザー**: 許可されたリンクのみ表示

### ユーザーメニュー

右上のユーザー名をクリックすると、以下のオプションが表示されます：
- **テーマ選択**: 画面の配色を変更
- **パスワード変更**: ログインパスワードを変更
- **ログアウト**: セッションを終了

---

## ポータルビルダーの使い方

ポータルビルダーでは、ポータルに表示するリンクを編集できます。

### リンクの追加

1. 「➕ リンクを追加」ボタンをクリック
2. 以下の情報を入力：
   - **ラベル**: 表示名（例：「KPI ダッシュボード」）
   - **URL**: リンク先URL
   - **アイコン**: Font Awesomeのクラス名（例：`fa-chart-bar`）
3. 「保存」をクリック

### リンクの編集

1. 編集したいカードの「✏️」ボタンをクリック
2. 情報を修正
3. 「保存」をクリック

### リンクの削除

1. 削除したいカードの「🗑️」ボタンをクリック
2. 確認ダイアログで「OK」をクリック

### リンクの並べ替え

カードをドラッグ＆ドロップで並べ替えができます。

### ポータルタイトルの変更

画面上部のタイトルをクリックして、新しいタイトルを入力できます。

### 設定の保存

「💾 保存」ボタンをクリックして、変更を保存します。

---

## 権限管理

### 権限の仕組み

ユーザー権限は `adminTools/mnguser/data/users/{username}.json` に保存されます。

```json
{
  "username": "user1",
  "permissions": [
    "http://localhost/mngtools/yoAdminBuilder/viewer.php?config=...",
    "http://localhost/mngtools/yoAdminPortal/builder.php"
  ]
}
```

### 権限の種類

| 権限 | 説明 |
|------|------|
| `*` | すべてのリンクにアクセス可能（管理者） |
| URL | 指定されたURLのみアクセス可能 |

### 権限の設定方法

1. ポータルから「利用者管理」を開く
2. ユーザーを選択
3. 権限チェックボックスで許可するツールを選択
4. 「保存」をクリック

---

## テーマ設定

### 利用可能なテーマ

| テーマ名 | 説明 |
|---------|------|
| 🌙 Dark | ダークモード（デフォルト） |
| ☀️ Light | ライトモード |
| 🔮 Midnight | 深い紫系のダーク |
| 🌊 Ocean | 海をイメージしたブルー系 |
| 🌲 Forest | 森をイメージしたグリーン系 |
| 🌅 Sunset | 夕焼けをイメージしたオレンジ系 |
| ⬜ Mono | モノクロ |
| 🌸 Rose | ピンク系 |

### テーマの変更方法

1. 右上のユーザーメニューを開く
2. 「Theme」のドロップダウンから選択
3. 即座に反映されます

テーマ設定はブラウザに保存され、次回アクセス時も維持されます。

---

## トラブルシューティング

### リンクが表示されない

**原因**: ユーザーにそのリンクへのアクセス権限がない

**解決方法**:
1. 管理者に権限の付与を依頼
2. または「利用者管理」で権限を追加

### 保存ボタンが効かない

**原因**: 設定ファイルの書き込み権限がない

**解決方法**:
1. `portal_config.json` の書き込み権限を確認
2. Webサーバーのユーザーに書き込み権限を付与

### ログインできない

**原因**: セッションがタイムアウトした

**解決方法**:
1. ページをリロード
2. 再度ログイン

### テーマが保存されない

**原因**: ブラウザのローカルストレージが無効

**解決方法**:
1. ブラウザの設定でCookieとサイトデータを許可
2. プライベートブラウジングモードを解除

---

## アイコン一覧（よく使うもの）

Font Awesome 6のアイコンクラス名を使用します。

| アイコン | クラス名 |
|---------|---------|
| 📊 グラフ | `fa-chart-bar`, `fa-chart-line`, `fa-chart-pie` |
| 👤 ユーザー | `fa-user`, `fa-users`, `fa-user-plus` |
| ⚙️ 設定 | `fa-cog`, `fa-gear`, `fa-sliders` |
| 📁 ファイル | `fa-folder`, `fa-file`, `fa-database` |
| 🔧 ツール | `fa-tools`, `fa-wrench`, `fa-hammer` |
| ⏰ 時間 | `fa-clock`, `fa-history`, `fa-calendar` |
| 🔒 セキュリティ | `fa-lock`, `fa-shield`, `fa-key` |

完全なアイコン一覧: [Font Awesome Icons](https://fontawesome.com/icons)

---

## 更新履歴

| 日付 | 内容 |
|------|------|
| 2026-01-29 | 初版作成 |

